(this["webpackJsonppart2-notes-backend"]=this["webpackJsonppart2-notes-backend"]||[]).push([[0],{44:function(t,e,n){},45:function(t,e,n){"use strict";n.r(e);var r=n(18),a=n.n(r),c=n(3),o=n.n(c),i=n(5),s=n(9),u=n(4),l=n(1),j=n(0),p=function(t){var e=t.note,n=t.toggleImportance,r=e.important?"make not important":"make important";return Object(j.jsxs)("li",{className:"note",children:[e.content,Object(j.jsx)("button",{onClick:n,children:r})]})},f=function(t){var e=t.message;return Object(j.jsx)("p",{className:"error",children:e})},d=function(){return Object(j.jsxs)("div",{style:{color:"green",fontStyle:"italic",fontSize:16},children:[Object(j.jsx)("br",{}),Object(j.jsx)("em",{children:"Note app, Department of Computer Science, University of Helsinki 2021"})]})},b=n(6),m=n.n(b),O="/api/notes",h=null,v=function(){var t=Object(i.a)(o.a.mark((function t(e){var n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={headers:{Authorization:h}},t.next=3,m.a.post(O,e,n);case 3:return r=t.sent,t.abrupt("return",r.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g={getAll:function(){var t=m.a.get(O),e={id:1e3,content:"This note is not saved to server",date:"2019-05-30T17:30:31.098Z",important:!1};return t.then((function(t){return t.data.concat(e)}))},create:v,update:function(t,e){return m.a.put("".concat(O,"/").concat(t),e).then((function(t){return t.data}))},setToken:function(t){h="bearer ".concat(t)}},x=function(){var t=Object(i.a)(o.a.mark((function t(e){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.post("/api/login",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),w={login:x},k=function(){var t=Object(l.useState)([]),e=Object(u.a)(t,2),n=e[0],r=e[1],a=Object(l.useState)(""),c=Object(u.a)(a,2),b=c[0],m=c[1],O=Object(l.useState)(!1),h=Object(u.a)(O,2),v=h[0],x=h[1],k=Object(l.useState)(""),S=Object(u.a)(k,2),y=S[0],N=S[1],T=Object(l.useState)(""),C=Object(u.a)(T,2),I=C[0],D=C[1],J=Object(l.useState)(null),U=Object(u.a)(J,2),_=U[0],A=U[1],E=Object(l.useState)(null),z=Object(u.a)(E,2),B=z[0],H=z[1];Object(l.useEffect)((function(){g.getAll().then((function(t){r(t)}))}),[]),Object(l.useEffect)((function(){var t=window.localStorage.getItem("loggedNoteappUser");if(t){var e=JSON.parse(t);A(e),g.setToken(e.token)}}),[]);var M=function(t){t.preventDefault();var e={content:b,date:(new Date).toISOString(),important:Math.random()>.5,id:n.length+1};g.create(e).then((function(t){r(n.concat(t)),m(""),H("Note '".concat(e.content,"' succesfully saved.")),setTimeout((function(){H(null)}),5e3)})).catch((function(t){console.log(t.response.data),H(t.response.data),setTimeout((function(){H(null)}),5e3)}))},P=function(t){m(t.target.value)},W=v?n:n.filter((function(t){return t.important})),Z=function(){var t=Object(i.a)(o.a.mark((function t(e){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.prev=1,t.next=4,w.login({username:y,password:I});case 4:n=t.sent,window.localStorage.setItem("loggedNoteappUser",JSON.stringify(n)),g.setToken(n.token),A(n),console.log("logging in with",y,I),N(""),D(""),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),H("Wrong credentials"),setTimeout((function(){H(null)}),1e5);case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"main_container",children:[Object(j.jsx)("h1",{children:"Notes"}),Object(j.jsx)(f,{message:B}),null===_?Object(j.jsx)("div",{className:"login_form_container",children:Object(j.jsxs)("form",{className:"login_form",onSubmit:Z,children:[Object(j.jsxs)("div",{children:["username",Object(j.jsx)("input",{type:"text",value:y,name:"Username",onChange:function(t){var e=t.target;return N(e.value)}})]}),Object(j.jsxs)("div",{children:["password",Object(j.jsx)("input",{type:"password",value:I,name:"Password",onChange:function(t){var e=t.target;return D(e.value)}})]}),Object(j.jsx)("button",{type:"submit",children:"login"})]})}):Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:[_.name," logged-in"]}),Object(j.jsxs)("form",{onSubmit:M,children:[Object(j.jsx)("input",{value:b,onChange:P}),Object(j.jsx)("button",{type:"submit",children:"save"})]})]}),Object(j.jsx)("div",{children:Object(j.jsxs)("button",{onClick:function(){return x(!v)},children:["show ",v?"important":"all"]})}),Object(j.jsx)("ul",{children:W.map((function(t){return Object(j.jsx)(p,{note:t,toggleImportance:function(){return function(t){var e=n.find((function(e){return e.id===t})),a=Object(s.a)(Object(s.a)({},e),{},{important:!e.important});g.update(t,a).then((function(e){r(n.map((function(n){return n.id!==t?n:e})))})).catch((function(a){H("Note '".concat(e.content,"' was already removed from server")),setTimeout((function(){H(null)}),5e3),r(n.filter((function(e){return e.id!==t})))}))}(t.id)}},t.id)}))}),Object(j.jsx)(d,{})]})};n(44);a.a.render(Object(j.jsx)(k,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.79ee60c2.chunk.js.map